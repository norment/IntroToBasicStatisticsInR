<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>10 Plotting | Introduction To Basic Statistics in R</title>
  <meta name="description" content="This document serves as a simple introduction to some of the basic principles in statistics in R." />
  <meta name="generator" content="bookdown 0.16.1 and GitBook 2.6.7" />

  <meta property="og:title" content="10 Plotting | Introduction To Basic Statistics in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This document serves as a simple introduction to some of the basic principles in statistics in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="10 Plotting | Introduction To Basic Statistics in R" />
  
  <meta name="twitter:description" content="This document serves as a simple introduction to some of the basic principles in statistics in R." />
  

<meta name="author" content="Version 1.1.0" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="power-analysis.html"/>
<link rel="next" href="a-full-analysis-script.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Basic Statistics in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="firstlook.html"><a href="firstlook.html"><i class="fa fa-check"></i><b>2</b> First look at R</a></li>
<li class="chapter" data-level="3" data-path="definitions-of-basic-princples.html"><a href="definitions-of-basic-princples.html"><i class="fa fa-check"></i><b>3</b> Definitions of basic princples</a></li>
<li class="chapter" data-level="4" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>4</b> Uncertainty</a></li>
<li class="chapter" data-level="5" data-path="distributions-probabilities.html"><a href="distributions-probabilities.html"><i class="fa fa-check"></i><b>5</b> Distributions &amp; Probabilities</a></li>
<li class="chapter" data-level="6" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>6</b> Basic Statistics</a><ul>
<li class="chapter" data-level="6.1" data-path="basic-statistics.html"><a href="basic-statistics.html#hypotheses-and-the-t-test"><i class="fa fa-check"></i><b>6.1</b> Hypotheses and the T-test</a></li>
<li class="chapter" data-level="6.2" data-path="basic-statistics.html"><a href="basic-statistics.html#anova"><i class="fa fa-check"></i><b>6.2</b> ANOVA</a></li>
<li class="chapter" data-level="6.3" data-path="basic-statistics.html"><a href="basic-statistics.html#correlation"><i class="fa fa-check"></i><b>6.3</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="probability-values.html"><a href="probability-values.html"><i class="fa fa-check"></i><b>7</b> Probability values</a></li>
<li class="chapter" data-level="8" data-path="the-multiple-testing-problem.html"><a href="the-multiple-testing-problem.html"><i class="fa fa-check"></i><b>8</b> The Multiple Testing Problem</a></li>
<li class="chapter" data-level="9" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>9</b> Power Analysis</a></li>
<li class="chapter" data-level="10" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>10</b> Plotting</a><ul>
<li class="chapter" data-level="10.1" data-path="plotting.html"><a href="plotting.html#basics-mapping"><i class="fa fa-check"></i><b>10.1</b> Basics &amp; Mapping</a></li>
<li class="chapter" data-level="10.2" data-path="plotting.html"><a href="plotting.html#types-of-plot"><i class="fa fa-check"></i><b>10.2</b> Types of plot</a></li>
<li class="chapter" data-level="10.3" data-path="plotting.html"><a href="plotting.html#layout-and-style"><i class="fa fa-check"></i><b>10.3</b> Layout and Style</a></li>
<li class="chapter" data-level="10.4" data-path="plotting.html"><a href="plotting.html#themes"><i class="fa fa-check"></i><b>10.4</b> Themes</a></li>
<li class="chapter" data-level="10.5" data-path="plotting.html"><a href="plotting.html#statistics-in-plots"><i class="fa fa-check"></i><b>10.5</b> Statistics in plots</a></li>
<li class="chapter" data-level="10.6" data-path="plotting.html"><a href="plotting.html#norment-options"><i class="fa fa-check"></i><b>10.6</b> NORMENT options</a></li>
<li class="chapter" data-level="10.7" data-path="plotting.html"><a href="plotting.html#more-examples"><i class="fa fa-check"></i><b>10.7</b> More examples</a></li>
<li class="chapter" data-level="10.8" data-path="plotting.html"><a href="plotting.html#repeated-meausures-anova"><i class="fa fa-check"></i><b>10.8</b> Repeated-Meausures ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="a-full-analysis-script.html"><a href="a-full-analysis-script.html"><i class="fa fa-check"></i><b>11</b> A Full Analysis Script</a></li>
<li class="chapter" data-level="12" data-path="futher-reading.html"><a href="futher-reading.html"><i class="fa fa-check"></i><b>12</b> Futher Reading</a></li>
<li class="chapter" data-level="13" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html"><i class="fa fa-check"></i><b>13</b> Appendix: semi-advanced R</a><ul>
<li class="chapter" data-level="13.1" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#sharing-your-data"><i class="fa fa-check"></i><b>13.1</b> Sharing your data</a></li>
<li class="chapter" data-level="13.2" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#for-loops"><i class="fa fa-check"></i><b>13.2</b> For-loops</a></li>
<li class="chapter" data-level="13.3" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#the-pipe"><i class="fa fa-check"></i><b>13.3</b> The pipe</a></li>
<li class="chapter" data-level="13.4" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#working-with-dates"><i class="fa fa-check"></i><b>13.4</b> Working with dates</a></li>
<li class="chapter" data-level="13.5" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#animations"><i class="fa fa-check"></i><b>13.5</b> Animations</a></li>
<li class="chapter" data-level="13.6" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#cowplot"><i class="fa fa-check"></i><b>13.6</b> Cowplot</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix-semi-advanced-statistics.html"><a href="appendix-semi-advanced-statistics.html"><i class="fa fa-check"></i><b>14</b> Appendix: semi-advanced statistics</a><ul>
<li class="chapter" data-level="14.1" data-path="appendix-semi-advanced-statistics.html"><a href="appendix-semi-advanced-statistics.html#anova-1"><i class="fa fa-check"></i><b>14.1</b> ANOVA</a></li>
<li class="chapter" data-level="14.2" data-path="appendix-semi-advanced-statistics.html"><a href="appendix-semi-advanced-statistics.html#everything-is-a-linear-model"><i class="fa fa-check"></i><b>14.2</b> Everything is a linear model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/norment" target="blank">Created for NORMENT</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction To Basic Statistics in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting" class="section level1">
<h1><span class="header-section-number">10</span> Plotting</h1>
<p>There’s a number of built-in functions that we can use, and one of those we’ve used already, such as <code>hist()</code>. Others are also quite self-explanatory such as <code>plot()</code>, or <code>barplot()</code>. I’ll just show one, since this one is apparently very difficult to make in SPSS: the <code>boxplot()</code> function. Let’s make a boxplot of the three groups. The setup is almost identical to the <code>aov()</code> function we used before.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="plotting.html#cb91-1"></a><span class="kw">boxplot</span>(scores <span class="op">~</span><span class="st"> </span>group, <span class="dt">data =</span> data_comb)</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-62-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>While this is already much better than the default output from SPSS, we can do better. And for that I want to introduce an immensely popular package. Once familiar with this package, you’ll recognize it on a great many manuscripts, posters and presentations: the <code>{ggplot2}</code> package. I’ll just create a plot first, and then I’ll go through how it works.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="plotting.html#cb92-1"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb92-2"><a href="plotting.html#cb92-2"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_comb, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> scores)) <span class="op">+</span></span>
<span id="cb92-3"><a href="plotting.html#cb92-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-63-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Just to show what is possible, the next plot has been made with just the <code>{ggplot2}</code> package and the <code>{ggpubr}</code> package. I won’t show the code just yet, but we might get to this level later, but this is what a fully modified <code>ggplot()</code> plot might look like:</p>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-65-1.png" width="672" style="display: block; margin: auto;" /></p>
<div id="basics-mapping" class="section level2">
<h2><span class="header-section-number">10.1</span> Basics &amp; Mapping</h2>
<p>Okay, so how do we go from the first simple plot to the second one? The functions in the <code>{ggplot2}</code> package effectively layer on top of each other. The first step is always a <code>ggplot()</code> function. Inside of this function you supply the data frame that contains the data you want to plot, and then you usually supply the <code>mapping</code> too. In the <code>mapping</code> you specify what you want on the x-axis, the y-axis, what the colors should represent (if anything), and there’s a few more options. You add the next layer by typing <code>+</code> at the end of the function.</p>
</div>
<div id="types-of-plot" class="section level2">
<h2><span class="header-section-number">10.2</span> Types of plot</h2>
<p>The second layer is usually the type of plot you want to use, in our last example this was <code>geom_boxplot()</code>, but other options include <code>geom_point()</code> (for scatterplots), <code>geom_line()</code> (for line plots), <code>geom_bar()</code> (for bar charts), and many more. And you can layer them, like I did in the last example, where I added a <code>geom_jitter()</code> first, and then a <code>geom_boxplot()</code> on top of that.</p>
<p>Let’s follow along, now we have a call to <code>ggplot()</code> and a call to <code>geom_jitter()</code> and <code>geom_boxplot()</code>. Both these functions take a number of inputs. You can find a full list of options in all functions of R by typing <code>?&lt;functionname&gt;</code>, e.g. <code>?geom_jitter</code>. <code>alpha</code> in this context means the opacity of the color, width of <code>geom_jitter()</code> specifies the width along which the dots will be jittered. The width in both functions is the width along points will be scattered, or the width of the boxplot. <code>outlier.shape</code> determines the behavior of the outliers, <code>outlier.shape = 4</code> changes the outlier to a little x.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="plotting.html#cb93-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_comb, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> scores, <span class="dt">fill =</span> group)) <span class="op">+</span></span>
<span id="cb93-2"><a href="plotting.html#cb93-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb93-3"><a href="plotting.html#cb93-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.9</span>, <span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">outlier.shape =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-67-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="layout-and-style" class="section level2">
<h2><span class="header-section-number">10.3</span> Layout and Style</h2>
<p>Next, we add a number of layers to make the plot look prettier and more informative. These layers contain information about what you want the axes labels to say, and the specific colors to use. There’s an infinite amount of options for the color palettes. There’s entire packages dedicated to make your colors resemble colors in the <a href="https://github.com/aljrico/harrypotter" target="_blank">Harry Poter universe</a>, the families from <a href="https://github.com/aljrico/gameofthrones" target="_blank">Game of Thrones</a>, the <a href="https://github.com/ewenme/ghibli" target="_blank">Ghibli movies</a>, or the palettes from the <a href="https://github.com/karthik/wesanderson" target="_blank">Wes Anderson movies</a>. The last one is pretty fun, so let’s use that. These color palettes are stored in the <code>{wesanderson}</code> package. Axes labels can be set with the <code>labs()</code> function, and the behavior of the axes itself can be set with <code>scale_x_discrete()</code> or <code>scale_y_continuous()</code> in this particular case. I think the x-axis looks good already, but I would like to change the y-axes behavior. For the colors we have two options, either a <code>color</code> setting or a <code>fill</code> setting. With a boxplot, the <code>color</code> setting will change just the lines of the boxplot, the <code>fill</code> setting changes the fill and not the lines. Keep this in mind when building your plot to always be consistent with the functions that affect the <code>color</code> or <code>fill</code>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="plotting.html#cb94-1"></a><span class="kw">library</span>(wesanderson)</span>
<span id="cb94-2"><a href="plotting.html#cb94-2"></a></span>
<span id="cb94-3"><a href="plotting.html#cb94-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_comb, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> scores, <span class="dt">fill =</span> group)) <span class="op">+</span></span>
<span id="cb94-4"><a href="plotting.html#cb94-4"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb94-5"><a href="plotting.html#cb94-5"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.9</span>, <span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">outlier.shape =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb94-6"><a href="plotting.html#cb94-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>, <span class="co"># NULL in this context means &quot;no label&quot;</span></span>
<span id="cb94-7"><a href="plotting.html#cb94-7"></a>       <span class="dt">y =</span> <span class="st">&quot;Score&quot;</span>,</span>
<span id="cb94-8"><a href="plotting.html#cb94-8"></a>       <span class="dt">fill =</span> <span class="ot">NULL</span>) <span class="op">+</span><span class="st"> </span><span class="co"># the fill in this case refers to the title of the legend</span></span>
<span id="cb94-9"><a href="plotting.html#cb94-9"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>), <span class="dt">minor_breaks =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb94-10"><a href="plotting.html#cb94-10"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">wes_palette</span>(<span class="st">&quot;IsleofDogs1&quot;</span>))</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-69-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>This is quite a bit better already, the different <code>scale_</code> functions might be a bit confusing at first, but Google is a great help. The <code>breaks</code> and <code>minor.breaks</code> options in the <code>scale_y_continuous()</code> function determine where major and minor grid lines along the y-axis will be shown. The <code>seq()</code> function creates a sequence from the first input to the second input in steps determined in the third input. For instance:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="plotting.html#cb95-1"></a><span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1 3 5 7 9</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="plotting.html#cb97-1"></a><span class="kw">seq</span>(<span class="dv">3</span>,<span class="dv">16</span>,<span class="dv">3</span>)</span></code></pre></div>
<pre><code>## [1]  3  6  9 12 15</code></pre>
<p>The <code>limits</code> option sets the absolute limits from as <code>c(&lt;lower limit&gt;, &lt;upper limit&gt;)</code>, since it’s good practice to always include the 0 in your plots when possible, and the maximum score anyone could have gotten was 10, we set the limits at 0 and 10 (i.e. sometimes you want to give limits some more space to allow for the random jitter to exceed the strict limits, e.g. <code>c(0, 10.2)</code>).</p>
</div>
<div id="themes" class="section level2">
<h2><span class="header-section-number">10.4</span> Themes</h2>
<p>The last layers typically are about the general layout of the plot. This is where we set the theme of the plot and the specific settings. A popular theme is <code>theme_minimal()</code> or <code>theme_bw()</code>. But the <code>{normentR}</code> package has a specific theme that corresponds with the NORMENT style guide, it’s called <code>theme_norment()</code>. This deals with a number of small modifications in the theme. There’s a number of great themes out there, and I’ve tried to collect the best options from each into the <code>theme_norment()</code> function, it includes a dark-mode, quite a few options for the font type, size, etc., functions to remove the background (great for posters), and a few more.</p>
<p>Further options that you want to change from the functions included in the <code>theme_&lt;theme function&gt;</code> can be set in the <code>theme()</code> function. This function has almost an infinite number of options. Googling it might help.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="plotting.html#cb99-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_comb, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> scores, <span class="dt">fill =</span> group)) <span class="op">+</span></span>
<span id="cb99-2"><a href="plotting.html#cb99-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb99-3"><a href="plotting.html#cb99-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.9</span>, <span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">outlier.shape =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb99-4"><a href="plotting.html#cb99-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb99-5"><a href="plotting.html#cb99-5"></a>       <span class="dt">y =</span> <span class="st">&quot;Score&quot;</span>,</span>
<span id="cb99-6"><a href="plotting.html#cb99-6"></a>       <span class="dt">fill =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb99-7"><a href="plotting.html#cb99-7"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>), <span class="dt">minor_breaks =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb99-8"><a href="plotting.html#cb99-8"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">wes_palette</span>(<span class="st">&quot;IsleofDogs1&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb99-9"><a href="plotting.html#cb99-9"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span><span class="st"> </span><span class="co"># set the NORMENT theme</span></span>
<span id="cb99-10"><a href="plotting.html#cb99-10"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb99-11"><a href="plotting.html#cb99-11"></a>    <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(), <span class="co"># remove the grid lines on the x-axis</span></span>
<span id="cb99-12"><a href="plotting.html#cb99-12"></a>    <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>) <span class="co"># make plot transparent</span></span>
<span id="cb99-13"><a href="plotting.html#cb99-13"></a>  )</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-72-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="statistics-in-plots" class="section level2">
<h2><span class="header-section-number">10.5</span> Statistics in plots</h2>
<p>I’ve included it in the plot earlier, but I’ll skip the pairwise T-tests for now. It’s quite simple with the <code>{ggpubr}</code> package, which includes a <code>stat_compare_means()</code> function which can be added as a layer to the plot. To add the ANOVA statistic, we just need to add the function to the plot, and specify the method we want to use in the <code>method</code> option. I’ll usually add this layer right after specifying the types of plot. The position of the ANOVA label can be moved to a specific place on the plot via the <code>label.x</code> and <code>label.y</code> options.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="plotting.html#cb100-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_comb, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> scores, <span class="dt">fill =</span> group)) <span class="op">+</span></span>
<span id="cb100-2"><a href="plotting.html#cb100-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb100-3"><a href="plotting.html#cb100-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.9</span>, <span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">outlier.shape =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb100-4"><a href="plotting.html#cb100-4"></a><span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">method =</span> <span class="st">&#39;anova&#39;</span>, <span class="dt">label.x =</span> <span class="fl">2.5</span>, <span class="dt">label.y =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb100-5"><a href="plotting.html#cb100-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb100-6"><a href="plotting.html#cb100-6"></a>       <span class="dt">y =</span> <span class="st">&quot;Score&quot;</span>,</span>
<span id="cb100-7"><a href="plotting.html#cb100-7"></a>       <span class="dt">fill =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb100-8"><a href="plotting.html#cb100-8"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>), <span class="dt">minor_breaks =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb100-9"><a href="plotting.html#cb100-9"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">wes_palette</span>(<span class="st">&quot;IsleofDogs1&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb100-10"><a href="plotting.html#cb100-10"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span></span>
<span id="cb100-11"><a href="plotting.html#cb100-11"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb100-12"><a href="plotting.html#cb100-12"></a>    <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb100-13"><a href="plotting.html#cb100-13"></a>    <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb100-14"><a href="plotting.html#cb100-14"></a>  )</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-74-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="norment-options" class="section level2">
<h2><span class="header-section-number">10.6</span> NORMENT options</h2>
<p>At the risk of sounding like I’m trying to chove the <code>{normentR}</code> package down your throat, I do want to measure some of the plotting from the <code>{normentR}</code> package. It has a specific function that sets the colors in the plot to NORMENT colors. It also has a function to add the NORMENT logo to any plot (called <code>show_norment_logo()</code>), which is great for presentations or sharing of figures on social media. Here I’ve created an example using some of these functions.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="plotting.html#cb101-1"></a>plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> data_comb, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> group, <span class="dt">y =</span> scores, <span class="dt">fill =</span> group)) <span class="op">+</span></span>
<span id="cb101-2"><a href="plotting.html#cb101-2"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> <span class="fl">0.1</span>) <span class="op">+</span></span>
<span id="cb101-3"><a href="plotting.html#cb101-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">alpha =</span> <span class="fl">0.9</span>, <span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">outlier.shape =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb101-4"><a href="plotting.html#cb101-4"></a><span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">method =</span> <span class="st">&#39;anova&#39;</span>, <span class="dt">label.x =</span> <span class="fl">2.5</span>, <span class="dt">label.y =</span> <span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb101-5"><a href="plotting.html#cb101-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="ot">NULL</span>,</span>
<span id="cb101-6"><a href="plotting.html#cb101-6"></a>       <span class="dt">y =</span> <span class="st">&quot;Score&quot;</span>,</span>
<span id="cb101-7"><a href="plotting.html#cb101-7"></a>       <span class="dt">fill =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb101-8"><a href="plotting.html#cb101-8"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>), <span class="dt">minor_breaks =</span> <span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">9</span>,<span class="dv">2</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb101-9"><a href="plotting.html#cb101-9"></a><span class="st">  </span><span class="kw">scale_fill_norment</span>(<span class="dt">discrete =</span> <span class="ot">TRUE</span>, <span class="dt">palette =</span> <span class="st">&quot;mixed&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb101-10"><a href="plotting.html#cb101-10"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span></span>
<span id="cb101-11"><a href="plotting.html#cb101-11"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb101-12"><a href="plotting.html#cb101-12"></a>    <span class="dt">panel.grid.major.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb101-13"><a href="plotting.html#cb101-13"></a>    <span class="dt">rect =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;transparent&quot;</span>)</span>
<span id="cb101-14"><a href="plotting.html#cb101-14"></a>  )</span>
<span id="cb101-15"><a href="plotting.html#cb101-15"></a><span class="kw">show_norment_logo</span>(plot)</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-76-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The package also contains a function to move the axis to a specific place on the plot, which is useful for ERP plotting for instance, this function is called <code>shift_axes()</code>. The color palettes included in the <code>{normentR}</code> package can be found using <code>show_norment_palette()</code>, which creates an image with the organization of different palettes.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="plotting.html#cb102-1"></a><span class="kw">show_norment_palette</span>()</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-77-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>You can create your own NORMENT palette by combining the colors manually. You can see the available colors by using the <code>norment_colors</code> command, which prints a list of the names and the HEX codes. You can create your own palette as shown below.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="plotting.html#cb103-1"></a>norment_colors</span></code></pre></div>
<pre><code>##       purple light purple      magenta         blue   light blue        green       yellow 
##    &quot;#5c2483&quot;    &quot;#814994&quot;    &quot;#e5007d&quot;    &quot;#0081c9&quot;    &quot;#3CA2E6&quot;    &quot;#21a695&quot;    &quot;#d3d800&quot; 
##        black         grey   light grey        white 
##    &quot;#000000&quot;    &quot;#384044&quot;    &quot;#cccccc&quot;    &quot;#ffffff&quot;</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="plotting.html#cb105-1"></a>my_norment &lt;-<span class="st"> </span><span class="kw">c</span>(norment_colors[[<span class="st">&quot;purple&quot;</span>]], norment_colors[[<span class="st">&quot;green&quot;</span>]], norment_colors[[<span class="st">&quot;yellow&quot;</span>]])</span>
<span id="cb105-2"><a href="plotting.html#cb105-2"></a><span class="kw">print</span>(my_norment)</span></code></pre></div>
<pre><code>## [1] &quot;#5c2483&quot; &quot;#21a695&quot; &quot;#d3d800&quot;</code></pre>
<p>I will admit that these colors are not great for individuals with colorblindness, or for printing in greyscale. There are some great packages available that will take care of this very elegantly, particularly the <code>{scico}</code> package, that can be found <a href="https://github.com/thomasp85/scico" target="_blank">here</a>.</p>
</div>
<div id="more-examples" class="section level2">
<h2><span class="header-section-number">10.7</span> More examples</h2>
<p>So now I want to go into a few more examples. For this we need to bring out the powerhouse of R, the <code>{tidyverse}</code> package. The <code>{tidyverse}</code> package contains a number of packages within to help move through your analysis in a more organized, easier, and generally better way. The <code>{tidyverse}</code> package is basically a collection of packages that include <code>{ggplot2}</code>, <code>{readr}</code> (to load data more efficiently), <code>{dplyr}</code> (to more effectively clean your data), and <code>{tidyr}</code> (to help organize your data in a tidy way), I might dedicate an entire section to the <code>{tidyverse}</code> later, but we’ll use some functions already now.</p>
<p>Let’s try some things out with this using some data from <a href="https://www.gapminder.org" target="_blank">Gapminder</a>. Gapminder data is also stored in the <code>{gapminder}</code> package, Let’s say we’re only interested in data from Norway, so we filter only the data from Norway. Let’s also select all data from 2007 from all countries. The <code>names()</code> function lists the names of columns. The <code>head()</code> function prints only the first few rows of the data frame instead of the full data frame like <code>print()</code> does.</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="plotting.html#cb107-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb107-2"><a href="plotting.html#cb107-2"></a><span class="kw">library</span>(gapminder)</span>
<span id="cb107-3"><a href="plotting.html#cb107-3"></a><span class="kw">names</span>(gapminder) <span class="co"># column names of the dataset</span></span></code></pre></div>
<pre><code>## [1] &quot;country&quot;   &quot;continent&quot; &quot;year&quot;      &quot;lifeExp&quot;   &quot;pop&quot;       &quot;gdpPercap&quot;</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="plotting.html#cb109-1"></a>data_norway &lt;-<span class="st"> </span><span class="kw">filter</span>(gapminder, country <span class="op">==</span><span class="st"> &quot;Norway&quot;</span>) <span class="co"># select only Norway</span></span>
<span id="cb109-2"><a href="plotting.html#cb109-2"></a>data_<span class="dv">2007</span> &lt;-<span class="st"> </span><span class="kw">filter</span>(gapminder, year <span class="op">==</span><span class="st"> </span><span class="dv">2007</span>) <span class="co"># select only 2007</span></span>
<span id="cb109-3"><a href="plotting.html#cb109-3"></a><span class="kw">print</span>(data_norway) <span class="co"># show all rows of data_norway</span></span></code></pre></div>
<pre><code>## # A tibble: 12 x 6
##    country continent  year lifeExp     pop gdpPercap
##    &lt;fct&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;     &lt;dbl&gt;
##  1 Norway  Europe     1952    72.7 3327728    10095.
##  2 Norway  Europe     1957    73.4 3491938    11654.
##  3 Norway  Europe     1962    73.5 3638919    13450.
##  4 Norway  Europe     1967    74.1 3786019    16362.
##  5 Norway  Europe     1972    74.3 3933004    18965.
##  6 Norway  Europe     1977    75.4 4043205    23311.
##  7 Norway  Europe     1982    76.0 4114787    26299.
##  8 Norway  Europe     1987    75.9 4186147    31541.
##  9 Norway  Europe     1992    77.3 4286357    33966.
## 10 Norway  Europe     1997    78.3 4405672    41283.
## 11 Norway  Europe     2002    79.0 4535591    44684.
## 12 Norway  Europe     2007    80.2 4627926    49357.</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="plotting.html#cb111-1"></a><span class="kw">head</span>(data_<span class="dv">2007</span>) <span class="co"># show the first few rows of data_2007</span></span></code></pre></div>
<pre><code>## # A tibble: 6 x 6
##   country     continent  year lifeExp      pop gdpPercap
##   &lt;fct&gt;       &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;    &lt;int&gt;     &lt;dbl&gt;
## 1 Afghanistan Asia       2007    43.8 31889923      975.
## 2 Albania     Europe     2007    76.4  3600523     5937.
## 3 Algeria     Africa     2007    72.3 33333216     6223.
## 4 Angola      Africa     2007    42.7 12420476     4797.
## 5 Argentina   Americas   2007    75.3 40301927    12779.
## 6 Australia   Oceania    2007    81.2 20434176    34435.</code></pre>
<p>So let’s do some plots again! First, I’m interested in how the life expectancy changed in Norway from the earliest recording to the most recent one in the dataset. I want to make a line plot for this. Let’s do it:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="plotting.html#cb113-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_norway, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> lifeExp)) <span class="op">+</span></span>
<span id="cb113-2"><a href="plotting.html#cb113-2"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-80-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>So this is the simplest <code>ggplot</code> we can make, but we can do better. Let’s add some elements we learned about earlier.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="plotting.html#cb114-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_norway, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> lifeExp)) <span class="op">+</span></span>
<span id="cb114-2"><a href="plotting.html#cb114-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># size refers to the width of the line</span></span>
<span id="cb114-3"><a href="plotting.html#cb114-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Year&quot;</span>,</span>
<span id="cb114-4"><a href="plotting.html#cb114-4"></a>       <span class="dt">y =</span> <span class="st">&quot;Life expectancy at birth (years)&quot;</span>) <span class="op">+</span></span>
<span id="cb114-5"><a href="plotting.html#cb114-5"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span></span>
<span id="cb114-6"><a href="plotting.html#cb114-6"></a><span class="st">  </span><span class="kw">theme</span>()</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-81-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now I want a scatter plot for all countries that had data recorded in 2007. At the same time, I’m also interested in the relationship with life expectancy with GDP per capita. So I’ll plot GDP per capita on the x-axis, and life expectancy on the y-axis. I want to color based on the continent, and the <code>{gapminder}</code> package has a set of colors for the continents stored in <code>continent_colors</code>.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="plotting.html#cb115-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_<span class="dv">2007</span>, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span></span>
<span id="cb115-2"><a href="plotting.html#cb115-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color =</span> continent), <span class="dt">size =</span> <span class="dv">3</span>, <span class="dt">alpha =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span><span class="co"># I want to only apply the color to the points</span></span>
<span id="cb115-3"><a href="plotting.html#cb115-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey20&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add a loess model to the points</span></span>
<span id="cb115-4"><a href="plotting.html#cb115-4"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> continent_colors) <span class="op">+</span></span>
<span id="cb115-5"><a href="plotting.html#cb115-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>,</span>
<span id="cb115-6"><a href="plotting.html#cb115-6"></a>       <span class="dt">y =</span> <span class="st">&quot;Life expectancy at birth (years)&quot;</span>,</span>
<span id="cb115-7"><a href="plotting.html#cb115-7"></a>       <span class="dt">color =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb115-8"><a href="plotting.html#cb115-8"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span></span>
<span id="cb115-9"><a href="plotting.html#cb115-9"></a><span class="st">  </span><span class="kw">theme</span>()</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-82-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>If we really wanted to recreate the famous Gapminder plots, we should make the size of the points dependent on the size of the populations, which we can do.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="plotting.html#cb116-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_<span class="dv">2007</span>, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> gdpPercap, <span class="dt">y =</span> lifeExp)) <span class="op">+</span></span>
<span id="cb116-2"><a href="plotting.html#cb116-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">color =</span> continent, <span class="dt">size =</span> pop), <span class="dt">alpha =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span><span class="co"># I want to only apply the color to the points</span></span>
<span id="cb116-3"><a href="plotting.html#cb116-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey20&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># add a loess model to the points</span></span>
<span id="cb116-4"><a href="plotting.html#cb116-4"></a><span class="st">  </span><span class="kw">scale_size_continuous</span>(<span class="dt">range =</span> <span class="kw">c</span>(<span class="fl">0.5</span>,<span class="dv">10</span>)) <span class="op">+</span></span>
<span id="cb116-5"><a href="plotting.html#cb116-5"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> continent_colors) <span class="op">+</span></span>
<span id="cb116-6"><a href="plotting.html#cb116-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;GDP per capita (US$)&quot;</span>,</span>
<span id="cb116-7"><a href="plotting.html#cb116-7"></a>       <span class="dt">y =</span> <span class="st">&quot;Life expectancy at birth (years)&quot;</span>,</span>
<span id="cb116-8"><a href="plotting.html#cb116-8"></a>       <span class="dt">color =</span> <span class="st">&quot;Continent&quot;</span>,</span>
<span id="cb116-9"><a href="plotting.html#cb116-9"></a>       <span class="dt">size =</span> <span class="st">&quot;Population&quot;</span>) <span class="op">+</span></span>
<span id="cb116-10"><a href="plotting.html#cb116-10"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span></span>
<span id="cb116-11"><a href="plotting.html#cb116-11"></a><span class="st">  </span><span class="kw">theme</span>(</span>
<span id="cb116-12"><a href="plotting.html#cb116-12"></a>    <span class="dt">legend.box =</span> <span class="st">&quot;vertical&quot;</span></span>
<span id="cb116-13"><a href="plotting.html#cb116-13"></a>  )</span></code></pre></div>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-83-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="repeated-meausures-anova" class="section level2">
<h2><span class="header-section-number">10.8</span> Repeated-Meausures ANOVA</h2>
<p>Okay, so now on to the more complicated work. Here I want to do a repeated-measures ANOVA. It is basically the same as running a regular ANOVA, instead now we want to include time as an interaction effect, and how else to add an interaction effect than to multiply the predictor by the effect of time. A <code>+</code> in this context, means a covariate, which should be interpreted as “controlled for <variable>”. Performing a post-hoc in this context makes little sense, since we don’t want to run more pairwise T-tests for more than 100 countries.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="plotting.html#cb117-1"></a>rep_anova_model &lt;-<span class="st"> </span><span class="kw">aov</span>(lifeExp <span class="op">~</span><span class="st"> </span>country<span class="op">*</span>year <span class="op">+</span><span class="st"> </span>gdpPercap, <span class="dt">data =</span> gapminder)</span>
<span id="cb117-2"><a href="plotting.html#cb117-2"></a><span class="kw">anova</span>(rep_anova_model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: lifeExp
##                Df Sum Sq Mean Sq   F value    Pr(&gt;F)    
## country       141 210176    1491   313.695 &lt; 2.2e-16 ***
## year            1  53919   53919 11347.140 &lt; 2.2e-16 ***
## gdpPercap       1    237     237    49.859 2.578e-12 ***
## country:year  141  13074      93    19.513 &lt; 2.2e-16 ***
## Residuals    1419   6743       5                        
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="power-analysis.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="a-full-analysis-script.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": false,
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
