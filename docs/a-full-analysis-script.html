<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 A Full Analysis Script | Introduction To Basic Statistics in R</title>
  <meta name="description" content="This document serves as a simple introduction to some of the basic principles in statistics in R." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="11 A Full Analysis Script | Introduction To Basic Statistics in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This document serves as a simple introduction to some of the basic principles in statistics in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 A Full Analysis Script | Introduction To Basic Statistics in R" />
  
  <meta name="twitter:description" content="This document serves as a simple introduction to some of the basic principles in statistics in R." />
  

<meta name="author" content="Version 1.1.0" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting.html"/>
<link rel="next" href="futher-reading.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Introduction to Basic Statistics in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="firstlook.html"><a href="firstlook.html"><i class="fa fa-check"></i><b>2</b> First look at R</a></li>
<li class="chapter" data-level="3" data-path="definitions-of-basic-princples.html"><a href="definitions-of-basic-princples.html"><i class="fa fa-check"></i><b>3</b> Definitions of basic princples</a></li>
<li class="chapter" data-level="4" data-path="uncertainty.html"><a href="uncertainty.html"><i class="fa fa-check"></i><b>4</b> Uncertainty</a></li>
<li class="chapter" data-level="5" data-path="distributions-probabilities.html"><a href="distributions-probabilities.html"><i class="fa fa-check"></i><b>5</b> Distributions &amp; Probabilities</a></li>
<li class="chapter" data-level="6" data-path="basic-statistics.html"><a href="basic-statistics.html"><i class="fa fa-check"></i><b>6</b> Basic Statistics</a><ul>
<li class="chapter" data-level="6.1" data-path="basic-statistics.html"><a href="basic-statistics.html#hypotheses-and-the-t-test"><i class="fa fa-check"></i><b>6.1</b> Hypotheses and the T-test</a></li>
<li class="chapter" data-level="6.2" data-path="basic-statistics.html"><a href="basic-statistics.html#anova"><i class="fa fa-check"></i><b>6.2</b> ANOVA</a></li>
<li class="chapter" data-level="6.3" data-path="basic-statistics.html"><a href="basic-statistics.html#correlation"><i class="fa fa-check"></i><b>6.3</b> Correlation</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="probability-values.html"><a href="probability-values.html"><i class="fa fa-check"></i><b>7</b> Probability values</a></li>
<li class="chapter" data-level="8" data-path="the-multiple-testing-problem.html"><a href="the-multiple-testing-problem.html"><i class="fa fa-check"></i><b>8</b> The Multiple Testing Problem</a></li>
<li class="chapter" data-level="9" data-path="power-analysis.html"><a href="power-analysis.html"><i class="fa fa-check"></i><b>9</b> Power Analysis</a></li>
<li class="chapter" data-level="10" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>10</b> Plotting</a><ul>
<li class="chapter" data-level="10.1" data-path="plotting.html"><a href="plotting.html#basics-mapping"><i class="fa fa-check"></i><b>10.1</b> Basics &amp; Mapping</a></li>
<li class="chapter" data-level="10.2" data-path="plotting.html"><a href="plotting.html#types-of-plot"><i class="fa fa-check"></i><b>10.2</b> Types of plot</a></li>
<li class="chapter" data-level="10.3" data-path="plotting.html"><a href="plotting.html#layout-and-style"><i class="fa fa-check"></i><b>10.3</b> Layout and Style</a></li>
<li class="chapter" data-level="10.4" data-path="plotting.html"><a href="plotting.html#themes"><i class="fa fa-check"></i><b>10.4</b> Themes</a></li>
<li class="chapter" data-level="10.5" data-path="plotting.html"><a href="plotting.html#statistics-in-plots"><i class="fa fa-check"></i><b>10.5</b> Statistics in plots</a></li>
<li class="chapter" data-level="10.6" data-path="plotting.html"><a href="plotting.html#norment-options"><i class="fa fa-check"></i><b>10.6</b> NORMENT options</a></li>
<li class="chapter" data-level="10.7" data-path="plotting.html"><a href="plotting.html#more-examples"><i class="fa fa-check"></i><b>10.7</b> More examples</a></li>
<li class="chapter" data-level="10.8" data-path="plotting.html"><a href="plotting.html#repeated-meausures-anova"><i class="fa fa-check"></i><b>10.8</b> Repeated-Meausures ANOVA</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="a-full-analysis-script.html"><a href="a-full-analysis-script.html"><i class="fa fa-check"></i><b>11</b> A Full Analysis Script</a></li>
<li class="chapter" data-level="12" data-path="futher-reading.html"><a href="futher-reading.html"><i class="fa fa-check"></i><b>12</b> Futher Reading</a></li>
<li class="chapter" data-level="13" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html"><i class="fa fa-check"></i><b>13</b> Appendix: semi-advanced R</a><ul>
<li class="chapter" data-level="13.1" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#sharing-your-data"><i class="fa fa-check"></i><b>13.1</b> Sharing your data</a></li>
<li class="chapter" data-level="13.2" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#for-loops"><i class="fa fa-check"></i><b>13.2</b> For-loops</a></li>
<li class="chapter" data-level="13.3" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#the-pipe"><i class="fa fa-check"></i><b>13.3</b> The pipe</a></li>
<li class="chapter" data-level="13.4" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#working-with-dates"><i class="fa fa-check"></i><b>13.4</b> Working with dates</a></li>
<li class="chapter" data-level="13.5" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#animations"><i class="fa fa-check"></i><b>13.5</b> Animations</a></li>
<li class="chapter" data-level="13.6" data-path="appendix-semi-advanced-r.html"><a href="appendix-semi-advanced-r.html#cowplot"><i class="fa fa-check"></i><b>13.6</b> Cowplot</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="appendix-semi-advanced-statistics.html"><a href="appendix-semi-advanced-statistics.html"><i class="fa fa-check"></i><b>14</b> Appendix: semi-advanced statistics</a><ul>
<li class="chapter" data-level="14.1" data-path="appendix-semi-advanced-statistics.html"><a href="appendix-semi-advanced-statistics.html#anova-1"><i class="fa fa-check"></i><b>14.1</b> ANOVA</a></li>
<li class="chapter" data-level="14.2" data-path="appendix-semi-advanced-statistics.html"><a href="appendix-semi-advanced-statistics.html#everything-is-a-linear-model"><i class="fa fa-check"></i><b>14.2</b> Everything is a linear model</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/norment" target="blank">Created for NORMENT</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction To Basic Statistics in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="a-full-analysis-script" class="section level1">
<h1><span class="header-section-number">11</span> A Full Analysis Script</h1>
<p>Okay, so all these code snippets are fun, but what would a full script look like? Here I’ll go through how I would typically write an analysis script. I’m sure those from others might look different, because they prefer to do things a little differently, but here’s mine. I’ll use some simulated data from TOP, so this is <em>not</em> real data. I’ll use a .csv-file here. If your data is currently in SPSS format, the easiest way to load this into R is by converting the SPSS file to a csv-file within SPSS. This is relatively simple:</p>
<ol style="list-style-type: decimal">
<li><p>Open your dataset in SPSS</p></li>
<li><p>Under the <code>File</code> tab, click <code>Save as...</code></p></li>
<li><p>Under <code>Save as type:</code>, select <code>Comma delimited (*.csv)</code></p></li>
<li><p>Also toggle the <code>Save value labels where defined instead of data values</code></p></li>
<li><p>Make sure <code>Write variable names to file</code> is selected</p></li>
</ol>
<!---
Before I start though, I should go into one important function, the `%>%`, it's called an operator, but is most commonly known as a "pipe". It "pipes" the output from the previous function into the next. For all pratical purposes the pipe should be interpreted as "take whatever we just did, and do the next thing on it". In the first example, we read in the SPSS data, and then we convert some variables to a factor using the `mutate()` function. This will get rid of the numerical values, and attach the value labels directly in the dataset. The `mutate()` function is a really powerful function that can convert, edit, or modify values within a variable. After the first step, you'll have one data frame in your workspace, called `data` that contains all the information that is also in the SPSS file.
--->
<p>Let’s now set up the packages that we want to use, and let’s load in the data with the <code>read.table()</code> function. The <code>header</code> option specifies whether the first line of the file should be considered a row with the column names, or variable names. The <code>sep</code> option specifies the delimiter for the file. If you exported from SPSS like described above, then the delimiter is a semicolon.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="a-full-analysis-script.html#cb122-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb122-2"><a href="a-full-analysis-script.html#cb122-2"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb122-3"><a href="a-full-analysis-script.html#cb122-3"></a><span class="kw">library</span>(normentR)</span>
<span id="cb122-4"><a href="a-full-analysis-script.html#cb122-4"></a></span>
<span id="cb122-5"><a href="a-full-analysis-script.html#cb122-5"></a>data &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;TOPdemographics.csv&quot;</span>)</span></code></pre></div>
<p>Then it’s generally best practice to inspect the data, so we can see what variables we have available with the <code>names()</code> function. If you’re working in Rstudio (which I recommend), then you can also just click on the <code>data</code> variable, or type <code>View(data)</code> to get a panel where the data is laid out like a spreadsheet, as you would get in SPSS.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="a-full-analysis-script.html#cb123-1"></a><span class="kw">names</span>(data)</span></code></pre></div>
<pre><code>##  [1] &quot;nnid&quot;             &quot;Diag_category&quot;    &quot;Gender&quot;           &quot;Pasient_Kontroll&quot;
##  [5] &quot;Ethnicity&quot;        &quot;AgeBaseline&quot;      &quot;score_panss&quot;      &quot;score_g&quot;         
##  [9] &quot;score_n&quot;          &quot;score_p&quot;          &quot;YMRS_score&quot;</code></pre>
<p>Next, let’s investigate, how many patients and how many controls do we have. The simplest way to do this is to create a table, using the <code>table()</code> function, we input to this the <code>Pasient_Kontroll</code> column.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="a-full-analysis-script.html#cb125-1"></a><span class="kw">table</span>(data<span class="op">$</span>Pasient_Kontroll)</span></code></pre></div>
<pre><code>## 
## Control Patient 
##    1221    1689</code></pre>
<p>Next, we also want to know what diagnoses our patients have, so we’ll do the same for the <code>Diag_category</code> column.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="a-full-analysis-script.html#cb127-1"></a><span class="kw">table</span>(data<span class="op">$</span>Diag_category)</span></code></pre></div>
<pre><code>## 
##                                           bipolar I                bipolar II 
##                      1248                       305                       183 
##                bipolarNOS                 cyclothym major depressive disorder 
##                        30                         2                        68 
##           other psychosis           schizoaffective             schizophrenia 
##                       218                       136                       667 
##          schizophreniform 
##                        53</code></pre>
<p>So now let’s say we want to compare schizophrenia spectrum with bipolar disorder spectrum patients. We then add to that column the diagoses, where we group the schizophrenia, schizophreniform, and schizoaffective patients together in one schizophrenia-spectrum group, and do the same for the bipolar patients. We can do this with the <code>fct_collapse()</code> function. We store the result in a new column in the <code>data</code> data frame, called <code>Diag_collapsed</code>. This function is very similar to the <code>recode</code> function in SPSS. There’s a little catch though. If you type <code>levels(data$Diag_category)</code>. you get the different options that this variable can have. It’s similar to looking at the “values” column in SPSS’ variable tab. Here we can see that one of the levels is just <code>" "</code>, which is different from <code>NA</code> since it’s just a character string with one empty space. These indicate individuals that have no diagnosis (yet). If we could just recode all of these into <code>"HC"</code>, that’d be great, but this column also involved patients that have no confirmed diagnosis yet. That’s why we also need a second option. Before we can recode, first we need to change the value in the <code>Diag_collapsed</code> column from subjects where the <code>Pasient_Kontroll</code> column indicates that it is a patient to <code>"Other"</code>, which is likely the most appropriate value for now. The easiest way to do this was via indexing. An example: <code>print(data$Diag_category)</code> will give the same result as <code>print(data[ ,"Diag_category"])</code>. In indexing, the first position is for the row number, the second for the column name or number. Just for illustration, typing <code>data[1000,"nnid"]</code>, will print the ID from the 1000th participant in the database. This is because indexing is done like this: <code>data[&lt;row&gt;,&lt;column&gt;]</code>, if either the <code>&lt;row&gt;</code> or <code>&lt;column&gt;</code> in this example is left empty, then it will take all rows or column, for instance <code>data[1000, ]</code> will print all columns from the 1000th participant, while <code>data[ ,"Diag_category"]</code> will print the <code>Diag_category</code> column from all participants. Below, we’ll use it to select all rows where the <code>Pasient_Kontroll</code> column is equal to <code>"Patient"</code>, and then apply the value <code>"Other"</code> only to the <code>"Diag_collapsed"</code> column. Afterwards, we can run the <code>fct_collapse()</code> function I discussed earlier.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="a-full-analysis-script.html#cb129-1"></a><span class="kw">levels</span>(data<span class="op">$</span>Diag_category)</span></code></pre></div>
<pre><code>##  [1] &quot; &quot;                         &quot;bipolar I&quot;                 &quot;bipolar II&quot;               
##  [4] &quot;bipolarNOS&quot;                &quot;cyclothym&quot;                 &quot;major depressive disorder&quot;
##  [7] &quot;other psychosis&quot;           &quot;schizoaffective&quot;           &quot;schizophrenia&quot;            
## [10] &quot;schizophreniform&quot;</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="a-full-analysis-script.html#cb131-1"></a>data[data<span class="op">$</span>Pasient_Kontroll <span class="op">==</span><span class="st"> &quot;Patient&quot;</span> <span class="op">&amp;</span><span class="st"> </span>data<span class="op">$</span>Diag_category <span class="op">==</span><span class="st"> &quot; &quot;</span>, <span class="st">&quot;Diag_collapsed&quot;</span>] =<span class="st"> &quot;Other&quot;</span></span>
<span id="cb131-2"><a href="a-full-analysis-script.html#cb131-2"></a>data<span class="op">$</span>Diag_collapsed &lt;-<span class="st"> </span><span class="kw">fct_collapse</span>(data<span class="op">$</span>Diag_category,</span>
<span id="cb131-3"><a href="a-full-analysis-script.html#cb131-3"></a>                                    <span class="dt">SCZ_spect =</span> <span class="kw">c</span>(<span class="st">&quot;schizophrenia&quot;</span>, <span class="st">&quot;schizophreniform&quot;</span>, <span class="st">&quot;schizoaffective&quot;</span>),</span>
<span id="cb131-4"><a href="a-full-analysis-script.html#cb131-4"></a>                                    <span class="dt">BD_spect =</span> <span class="kw">c</span>(<span class="st">&quot;bipolar I&quot;</span>, <span class="st">&quot;bipolarNOS&quot;</span>, <span class="st">&quot;bipolar II&quot;</span>),</span>
<span id="cb131-5"><a href="a-full-analysis-script.html#cb131-5"></a>                                    <span class="dt">HC =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb131-6"><a href="a-full-analysis-script.html#cb131-6"></a>                                    <span class="dt">group_other =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## Warning in fct_collapse(data$Diag_category, SCZ_spect = c(&quot;schizophrenia&quot;, : `group_other`
## is deprecated. Please use `other_level` instead</code></pre>
<p>Now we have a column called <code>Diag_collapsed</code> that has four levels: <code>"SCZ_spect"</code>, <code>"BD_spect"</code>, <code>"Other"</code>, and <code>"HC"</code>. So what are the numbers now?</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="a-full-analysis-script.html#cb133-1"></a><span class="kw">table</span>(data<span class="op">$</span>Diag_collapsed)</span></code></pre></div>
<pre><code>## 
##        HC  BD_spect SCZ_spect     Other 
##      1248       518       856       288</code></pre>
<p>Suppose we’re interested in YMRS and PANSS scores. Let’s immediately dive into some plotting.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="a-full-analysis-script.html#cb135-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Diag_collapsed, <span class="dt">y =</span> score_panss)) <span class="op">+</span></span>
<span id="cb135-2"><a href="a-full-analysis-script.html#cb135-2"></a><span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb135-3"><a href="a-full-analysis-script.html#cb135-3"></a><span class="st">  </span><span class="kw">theme_norment</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 1286 rows containing non-finite values (stat_ydensity).</code></pre>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-104-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="a-full-analysis-script.html#cb137-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Diag_collapsed, <span class="dt">y =</span> YMRS_score)) <span class="op">+</span></span>
<span id="cb137-2"><a href="a-full-analysis-script.html#cb137-2"></a><span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb137-3"><a href="a-full-analysis-script.html#cb137-3"></a><span class="st">  </span><span class="kw">theme_norment</span>()</span></code></pre></div>
<pre><code>## Warning: Removed 1445 rows containing non-finite values (stat_ydensity).</code></pre>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-104-2.png" width="672" style="display: block; margin: auto;" /></p>
<p>From these plots we can see that the data is quite skewed, especially the YMRS. So before we want do any statistics, we should probably quantify whether the data is normally distributed. For this we have the <code>shapiro.test()</code> that we’ve used before.</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="a-full-analysis-script.html#cb139-1"></a><span class="kw">shapiro.test</span>(data<span class="op">$</span>score_panss)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  data$score_panss
## W = 0.94831, p-value &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="a-full-analysis-script.html#cb141-1"></a><span class="kw">shapiro.test</span>(data<span class="op">$</span>YMRS_score)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  data$YMRS_score
## W = 0.80452, p-value &lt; 2.2e-16</code></pre>
<p>So it appears that both variables are significantly different from a normal distribution, so we violate some assumptions of the statistical tests we might do, such as the T-test and the ANOVA and in general all parametric tests. So we need to consider a non-parametric test. Since we’re interested only in the comparison between schizophrenia, bipolar disorder, and healthy controls, we remove all incidences of <code>"Other"</code> from the dataset, we do this by using the <code>filter()</code> function. We’ve used the <code>==</code> operator before, but now we’ll use the opposite <code>!=</code>, which translates to “not equal to”. Then we’ll use the non-parametric equivalent of the ANOVA, which is the Kruskal-Willis test, implemented in R with the <code>kruskal.test()</code> function.</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="a-full-analysis-script.html#cb143-1"></a><span class="kw">kruskal.test</span>(<span class="dt">formula =</span> score_panss <span class="op">~</span><span class="st"> </span>Diag_collapsed, <span class="dt">data =</span> data)</span></code></pre></div>
<pre><code>## 
##  Kruskal-Wallis rank sum test
## 
## data:  score_panss by Diag_collapsed
## Kruskal-Wallis chi-squared = 432.71, df = 3, p-value &lt; 2.2e-16</code></pre>
<p>Then we’ll want to make some plot, preferably a pretty boxplot. Note that since healthy controls don’t have a score on either the PANSS or the YMRS, this will be empty, and R will tell you that it couldn’t show a number of rows.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="a-full-analysis-script.html#cb145-1"></a>data_plot &lt;-<span class="st"> </span><span class="kw">filter</span>(data, Diag_collapsed <span class="op">!=</span><span class="st"> &quot;HC&quot;</span>)</span>
<span id="cb145-2"><a href="a-full-analysis-script.html#cb145-2"></a>bplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data_plot, <span class="kw">aes</span>(<span class="dt">x =</span> Diag_collapsed, <span class="dt">y =</span> score_panss, <span class="dt">fill =</span> Diag_collapsed)) <span class="op">+</span></span>
<span id="cb145-3"><a href="a-full-analysis-script.html#cb145-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb145-4"><a href="a-full-analysis-script.html#cb145-4"></a><span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">method =</span> <span class="st">&quot;kruskal&quot;</span>) <span class="op">+</span></span>
<span id="cb145-5"><a href="a-full-analysis-script.html#cb145-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Diagnosis&quot;</span>,</span>
<span id="cb145-6"><a href="a-full-analysis-script.html#cb145-6"></a>       <span class="dt">y =</span> <span class="st">&quot;PANSS score (total)&quot;</span>,</span>
<span id="cb145-7"><a href="a-full-analysis-script.html#cb145-7"></a>       <span class="dt">fill =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb145-8"><a href="a-full-analysis-script.html#cb145-8"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;BD&quot;</span>, <span class="st">&quot;SCZ&quot;</span>,<span class="st">&quot;Other&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb145-9"><a href="a-full-analysis-script.html#cb145-9"></a><span class="st">  </span><span class="kw">scale_fill_norment</span>(<span class="dt">discrete =</span> <span class="ot">TRUE</span>, <span class="dt">palette =</span> <span class="st">&quot;powerpoint&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;SCZ&quot;</span>, <span class="st">&quot;BD&quot;</span>, <span class="st">&quot;HC&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb145-10"><a href="a-full-analysis-script.html#cb145-10"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb145-11"><a href="a-full-analysis-script.html#cb145-11"></a><span class="st">  </span><span class="kw">theme</span>()</span>
<span id="cb145-12"><a href="a-full-analysis-script.html#cb145-12"></a><span class="kw">print</span>(bplot)</span>
<span id="cb145-13"><a href="a-full-analysis-script.html#cb145-13"></a><span class="kw">ggsave</span>(<span class="dt">plot =</span> bplot, <span class="dt">file =</span> <span class="st">&quot;figures/boxplot.png&quot;</span>)</span></code></pre></div>
<pre><code>## Saving 7 x 5 in image</code></pre>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-107-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>The <code>ggsave()</code> function saves the plot as an image in the working directory specified. If you don’t specify a folder, it will save it in the current working directory, you can get the current working directory by typing <code>getwd()</code>.</p>
<p>Let’s also run a correlation, between the age and the score on the PANSS for patients with schizophrenia only. We can do this with the <code>cor.test()</code> function. You input the two columns you want to use, and the most appropriate method (either <code>"pearson"</code>, <code>"kendall"</code>, or "<code>spearman"</code>).</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="a-full-analysis-script.html#cb147-1"></a>data_scz &lt;-<span class="st"> </span><span class="kw">filter</span>(data, Diag_collapsed <span class="op">==</span><span class="st"> &quot;SCZ_spect&quot;</span>)</span>
<span id="cb147-2"><a href="a-full-analysis-script.html#cb147-2"></a><span class="kw">cor.test</span>(data_scz<span class="op">$</span>AgeBaseline, data_scz<span class="op">$</span>score_panss, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span></code></pre></div>
<pre><code>## Warning in cor.test.default(data_scz$AgeBaseline, data_scz$score_panss, : Cannot compute
## exact p-value with ties</code></pre>
<pre><code>## 
##  Spearman&#39;s rank correlation rho
## 
## data:  data_scz$AgeBaseline and data_scz$score_panss
## S = 109823369, p-value = 0.0002118
## alternative hypothesis: true rho is not equal to 0
## sample estimates:
##        rho 
## -0.1277889</code></pre>
<p>Let’s also make a scatter plot to see if this makes sense.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="a-full-analysis-script.html#cb150-1"></a>scplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data_scz, <span class="kw">aes</span>(<span class="dt">x =</span> AgeBaseline, <span class="dt">y =</span> score_panss, <span class="dt">color =</span> Gender)) <span class="op">+</span></span>
<span id="cb150-2"><a href="a-full-analysis-script.html#cb150-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb150-3"><a href="a-full-analysis-script.html#cb150-3"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey30&quot;</span>) <span class="op">+</span></span>
<span id="cb150-4"><a href="a-full-analysis-script.html#cb150-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age at baseline&quot;</span>,</span>
<span id="cb150-5"><a href="a-full-analysis-script.html#cb150-5"></a>       <span class="dt">y =</span> <span class="st">&quot;Score PANSS (total)&quot;</span>,</span>
<span id="cb150-6"><a href="a-full-analysis-script.html#cb150-6"></a>       <span class="dt">color =</span> <span class="st">&quot;Sex&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb150-7"><a href="a-full-analysis-script.html#cb150-7"></a><span class="st">  </span><span class="kw">scale_color_norment</span>(<span class="dt">discrete =</span> <span class="ot">TRUE</span>, <span class="dt">palette =</span> <span class="st">&quot;logo&quot;</span>) <span class="op">+</span></span>
<span id="cb150-8"><a href="a-full-analysis-script.html#cb150-8"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span></span>
<span id="cb150-9"><a href="a-full-analysis-script.html#cb150-9"></a><span class="st">  </span><span class="kw">theme</span>()</span>
<span id="cb150-10"><a href="a-full-analysis-script.html#cb150-10"></a><span class="kw">print</span>(scplot)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="a-full-analysis-script.html#cb152-1"></a><span class="kw">ggsave</span>(scplot, <span class="dt">file =</span> <span class="st">&quot;figures/scatterplot.png&quot;</span>)</span></code></pre></div>
<pre><code>## Saving 7 x 5 in image
## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="IntroToBasicStatisticsInR_files/figure-html/unnamed-chunk-109-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Yes, it does, it seems there’s no direct association between age and PANSS, I’ll just say that I’m not a psychologist, and I’m not sure whether we should expect a correlation and what important covariates I missed, but this is just for illustration purposes.</p>
<p>All in all, this is what a simple script would look like. In the full script below I’ve added comments to make things clearer. If you hadn’t noticed it yet, comments are added by typing <code>#</code>, followed by whatever your comment is. Comments are not evaluated when running the code.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="a-full-analysis-script.html#cb154-1"></a><span class="co"># Load packages ####</span></span>
<span id="cb154-2"><a href="a-full-analysis-script.html#cb154-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb154-3"><a href="a-full-analysis-script.html#cb154-3"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb154-4"><a href="a-full-analysis-script.html#cb154-4"></a><span class="kw">library</span>(normentR)</span>
<span id="cb154-5"><a href="a-full-analysis-script.html#cb154-5"></a></span>
<span id="cb154-6"><a href="a-full-analysis-script.html#cb154-6"></a><span class="co"># Load data ####</span></span>
<span id="cb154-7"><a href="a-full-analysis-script.html#cb154-7"></a>data &lt;-<span class="st"> </span><span class="kw">read.csv2</span>(<span class="st">&quot;TOPdemographics.csv&quot;</span>)</span>
<span id="cb154-8"><a href="a-full-analysis-script.html#cb154-8"></a></span>
<span id="cb154-9"><a href="a-full-analysis-script.html#cb154-9"></a><span class="co"># Inspect data ####</span></span>
<span id="cb154-10"><a href="a-full-analysis-script.html#cb154-10"></a><span class="kw">names</span>(data)</span>
<span id="cb154-11"><a href="a-full-analysis-script.html#cb154-11"></a></span>
<span id="cb154-12"><a href="a-full-analysis-script.html#cb154-12"></a><span class="kw">table</span>(data<span class="op">$</span>Pasient_Kontroll)</span>
<span id="cb154-13"><a href="a-full-analysis-script.html#cb154-13"></a><span class="kw">table</span>(data<span class="op">$</span>Diag_category)</span>
<span id="cb154-14"><a href="a-full-analysis-script.html#cb154-14"></a></span>
<span id="cb154-15"><a href="a-full-analysis-script.html#cb154-15"></a><span class="co"># Collapse diagnoses ####</span></span>
<span id="cb154-16"><a href="a-full-analysis-script.html#cb154-16"></a></span>
<span id="cb154-17"><a href="a-full-analysis-script.html#cb154-17"></a><span class="kw">levels</span>(data<span class="op">$</span>Diag_category)</span>
<span id="cb154-18"><a href="a-full-analysis-script.html#cb154-18"></a></span>
<span id="cb154-19"><a href="a-full-analysis-script.html#cb154-19"></a>data[data<span class="op">$</span>Pasient_Kontroll <span class="op">==</span><span class="st"> &quot;Patient&quot;</span> <span class="op">&amp;</span><span class="st"> </span>data<span class="op">$</span>Diag_category <span class="op">==</span><span class="st"> &quot; &quot;</span>, <span class="st">&quot;Diag_collapsed&quot;</span>] =<span class="st"> &quot;Other&quot;</span></span>
<span id="cb154-20"><a href="a-full-analysis-script.html#cb154-20"></a>data<span class="op">$</span>Diag_collapsed &lt;-<span class="st"> </span><span class="kw">fct_collapse</span>(data<span class="op">$</span>Diag_category,</span>
<span id="cb154-21"><a href="a-full-analysis-script.html#cb154-21"></a>                                    <span class="dt">SCZ_spect =</span> <span class="kw">c</span>(<span class="st">&quot;schizophrenia&quot;</span>, <span class="st">&quot;schizophreniform&quot;</span>, <span class="st">&quot;schizoaffective&quot;</span>),</span>
<span id="cb154-22"><a href="a-full-analysis-script.html#cb154-22"></a>                                    <span class="dt">BD_spect =</span> <span class="kw">c</span>(<span class="st">&quot;bipolar I&quot;</span>, <span class="st">&quot;bipolarNOS&quot;</span>, <span class="st">&quot;bipolar II&quot;</span>),</span>
<span id="cb154-23"><a href="a-full-analysis-script.html#cb154-23"></a>                                    <span class="dt">HC =</span> <span class="st">&quot; &quot;</span>,</span>
<span id="cb154-24"><a href="a-full-analysis-script.html#cb154-24"></a>                                    <span class="dt">group_other =</span> <span class="ot">TRUE</span>)</span>
<span id="cb154-25"><a href="a-full-analysis-script.html#cb154-25"></a></span>
<span id="cb154-26"><a href="a-full-analysis-script.html#cb154-26"></a><span class="kw">table</span>(data<span class="op">$</span>Diag_collapsed)</span>
<span id="cb154-27"><a href="a-full-analysis-script.html#cb154-27"></a></span>
<span id="cb154-28"><a href="a-full-analysis-script.html#cb154-28"></a><span class="co"># Inspect clinical variables ####</span></span>
<span id="cb154-29"><a href="a-full-analysis-script.html#cb154-29"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Diag_collapsed, <span class="dt">y =</span> score_panss)) <span class="op">+</span></span>
<span id="cb154-30"><a href="a-full-analysis-script.html#cb154-30"></a><span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb154-31"><a href="a-full-analysis-script.html#cb154-31"></a><span class="st">  </span><span class="kw">theme_norment</span>()</span>
<span id="cb154-32"><a href="a-full-analysis-script.html#cb154-32"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Diag_collapsed, <span class="dt">y =</span> YMRS_score)) <span class="op">+</span></span>
<span id="cb154-33"><a href="a-full-analysis-script.html#cb154-33"></a><span class="st">  </span><span class="kw">geom_violin</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb154-34"><a href="a-full-analysis-script.html#cb154-34"></a><span class="st">  </span><span class="kw">theme_norment</span>()</span>
<span id="cb154-35"><a href="a-full-analysis-script.html#cb154-35"></a></span>
<span id="cb154-36"><a href="a-full-analysis-script.html#cb154-36"></a><span class="co"># Run statistics ####</span></span>
<span id="cb154-37"><a href="a-full-analysis-script.html#cb154-37"></a></span>
<span id="cb154-38"><a href="a-full-analysis-script.html#cb154-38"></a><span class="co"># Test for normality</span></span>
<span id="cb154-39"><a href="a-full-analysis-script.html#cb154-39"></a><span class="kw">shapiro.test</span>(data<span class="op">$</span>score_panss)</span>
<span id="cb154-40"><a href="a-full-analysis-script.html#cb154-40"></a><span class="kw">shapiro.test</span>(data<span class="op">$</span>YMRS_score)</span>
<span id="cb154-41"><a href="a-full-analysis-script.html#cb154-41"></a></span>
<span id="cb154-42"><a href="a-full-analysis-script.html#cb154-42"></a><span class="co"># Kruskal-Wallis</span></span>
<span id="cb154-43"><a href="a-full-analysis-script.html#cb154-43"></a>data_clean &lt;-<span class="st"> </span><span class="kw">filter</span>(data, Diag_collapsed <span class="op">!=</span><span class="st"> &quot;Other&quot;</span>)</span>
<span id="cb154-44"><a href="a-full-analysis-script.html#cb154-44"></a><span class="kw">kruskal.test</span>(<span class="dt">formula =</span> score_panss <span class="op">~</span><span class="st"> </span>Diag_collapsed, <span class="dt">data =</span> data_clean)</span>
<span id="cb154-45"><a href="a-full-analysis-script.html#cb154-45"></a>data_plot &lt;-<span class="st"> </span><span class="kw">filter</span>(data_clean, Diag_collapsed <span class="op">!=</span><span class="st"> &quot;HC&quot;</span>)</span>
<span id="cb154-46"><a href="a-full-analysis-script.html#cb154-46"></a></span>
<span id="cb154-47"><a href="a-full-analysis-script.html#cb154-47"></a><span class="co"># Create boxplot</span></span>
<span id="cb154-48"><a href="a-full-analysis-script.html#cb154-48"></a>bplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data_plot, <span class="kw">aes</span>(<span class="dt">x =</span> Diag_collapsed, <span class="dt">y =</span> score_panss, <span class="dt">fill =</span> Diag_collapsed)) <span class="op">+</span></span>
<span id="cb154-49"><a href="a-full-analysis-script.html#cb154-49"></a><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">0.5</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb154-50"><a href="a-full-analysis-script.html#cb154-50"></a><span class="st">  </span><span class="kw">stat_compare_means</span>(<span class="dt">method =</span> <span class="st">&quot;kruskal&quot;</span>) <span class="op">+</span></span>
<span id="cb154-51"><a href="a-full-analysis-script.html#cb154-51"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Diagnosis&quot;</span>,</span>
<span id="cb154-52"><a href="a-full-analysis-script.html#cb154-52"></a>       <span class="dt">y =</span> <span class="st">&quot;PANSS score (total)&quot;</span>,</span>
<span id="cb154-53"><a href="a-full-analysis-script.html#cb154-53"></a>       <span class="dt">fill =</span> <span class="ot">NULL</span>) <span class="op">+</span></span>
<span id="cb154-54"><a href="a-full-analysis-script.html#cb154-54"></a><span class="st">  </span><span class="kw">scale_x_discrete</span>(<span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;BD&quot;</span>, <span class="st">&quot;SCZ&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb154-55"><a href="a-full-analysis-script.html#cb154-55"></a><span class="st">  </span><span class="kw">scale_fill_norment</span>(<span class="dt">discrete =</span> <span class="ot">TRUE</span>, <span class="dt">palette =</span> <span class="st">&quot;powerpoint&quot;</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;BD&quot;</span>, <span class="st">&quot;SCZ&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb154-56"><a href="a-full-analysis-script.html#cb154-56"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb154-57"><a href="a-full-analysis-script.html#cb154-57"></a><span class="st">  </span><span class="kw">theme</span>()</span>
<span id="cb154-58"><a href="a-full-analysis-script.html#cb154-58"></a><span class="kw">print</span>(bplot)</span>
<span id="cb154-59"><a href="a-full-analysis-script.html#cb154-59"></a><span class="kw">ggsave</span>(<span class="dt">plot =</span> bplot, <span class="dt">file =</span> <span class="st">&quot;boxplot.png&quot;</span>)</span>
<span id="cb154-60"><a href="a-full-analysis-script.html#cb154-60"></a></span>
<span id="cb154-61"><a href="a-full-analysis-script.html#cb154-61"></a><span class="co"># Correlation between age and PANSS</span></span>
<span id="cb154-62"><a href="a-full-analysis-script.html#cb154-62"></a>data_scz &lt;-<span class="st"> </span><span class="kw">filter</span>(data_clean, Diag_collapsed <span class="op">==</span><span class="st"> &quot;SCZ_spect&quot;</span>)</span>
<span id="cb154-63"><a href="a-full-analysis-script.html#cb154-63"></a><span class="kw">cor.test</span>(data_scz<span class="op">$</span>AgeBaseline, data_scz<span class="op">$</span>score_panss, <span class="dt">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb154-64"><a href="a-full-analysis-script.html#cb154-64"></a></span>
<span id="cb154-65"><a href="a-full-analysis-script.html#cb154-65"></a>scplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(data_scz, <span class="kw">aes</span>(<span class="dt">x =</span> AgeBaseline, <span class="dt">y =</span> score_panss, <span class="dt">color =</span> Gender)) <span class="op">+</span></span>
<span id="cb154-66"><a href="a-full-analysis-script.html#cb154-66"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.75</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb154-67"><a href="a-full-analysis-script.html#cb154-67"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;grey30&quot;</span>) <span class="op">+</span></span>
<span id="cb154-68"><a href="a-full-analysis-script.html#cb154-68"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Age at baseline&quot;</span>,</span>
<span id="cb154-69"><a href="a-full-analysis-script.html#cb154-69"></a>       <span class="dt">y =</span> <span class="st">&quot;Score PANSS (total)&quot;</span>,</span>
<span id="cb154-70"><a href="a-full-analysis-script.html#cb154-70"></a>       <span class="dt">color =</span> <span class="st">&quot;Sex&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb154-71"><a href="a-full-analysis-script.html#cb154-71"></a><span class="st">  </span><span class="kw">scale_color_norment</span>(<span class="dt">discrete =</span> <span class="ot">TRUE</span>, <span class="dt">palette =</span> <span class="st">&quot;logo&quot;</span>) <span class="op">+</span></span>
<span id="cb154-72"><a href="a-full-analysis-script.html#cb154-72"></a><span class="st">  </span><span class="kw">theme_norment</span>() <span class="op">+</span></span>
<span id="cb154-73"><a href="a-full-analysis-script.html#cb154-73"></a><span class="st">  </span><span class="kw">theme</span>()</span>
<span id="cb154-74"><a href="a-full-analysis-script.html#cb154-74"></a><span class="kw">print</span>(scplot)</span>
<span id="cb154-75"><a href="a-full-analysis-script.html#cb154-75"></a><span class="kw">ggsave</span>(scplot, <span class="dt">file =</span> <span class="st">&quot;scatterplot.png&quot;</span>)</span></code></pre></div>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="futher-reading.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": false,
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
